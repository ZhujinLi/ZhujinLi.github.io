<!DOCTYPE html><html><head><title>Frame synchronization issues - DemoHut</title><link rel="stylesheet" href="/main.css"></head><body><div class="jumbotron jumbotron-fluid text-monospace" id="jumbotron"><div class="container" style="position: relative"><h1><a href="/">DemoHut</a></h1><a class="text-secondary" href="/about_me.json" target="_blank" style="position: absolute; right: 15px; bottom: 0px;">About me</a></div></div><div class="container"><form class="text-right" action="/"><button class="btn btn-outline-primary" type="submit">← all posts</button></form><div class="display-4"><p>Frame synchronization issues</p></div><div id="content"><p>A normal motion looks like this:</p><canvas id="view-normal"></canvas><p>Most PC gamers know a fact: if V-sync is off, tearing may occur in some frames:</p><div style="position: relative; margin-top: 20px; margin-bottom: 20px; height:300px; width:1000px"><canvas id="plot-v-sync"></canvas></div><canvas id="view-v-sync"></canvas><p>The tearing artifact is caused by framebuffer swapping. If the monitor happens to read the front framebuffer during the swapping, the old content mixed with new one is presented onto the screen, and tearing occurs.</p><p>Recently I've encountered another type of syncrhonization problem in my work project. I was developing animation module for mobile map apps, which involves these steps:</p><ol><li>C++ animation timer callbacks at 100HZ, and the map camera's state is updated</li><li>iOS app adaption-layer also receives the callback and set a variable for refreshing</li><li>iOS app 60HZ-fixed-rate render method of CADisplayLink checks the variable and refresh a new map frame</li></ol><p>When degugging I found the animation a little bit stuttering, just like the above example without tearing:</p><div style="position: relative; margin-top: 20px; margin-bottom: 20px; height:300px; width:1000px"><canvas id="plot-timer-sync"></canvas></div><canvas id="view-timer-sync"></canvas><p>The problem is that the timer in step 1 and rendering in step 3 are not synchronized, so at the time the map is rendered, the camera state is out of date. To fix this, simply delay the update of the camera to render-time, and the animation would become really smooth.</p><p>Similarly, if the V-sync is turned on in games, there will be lagging as well. It is the place where techniques like Nvidia G-sync come in handy.</p><script src="./subj-frame-sync.js" type="module"></script></div><a class="text-right" href="https://gitee.com/xyuv/xyuv/tree/master/_source_code/src/subjs/subj-frame-sync" target="_blank"><p>→ view src</p></a><div class="hr-theme-slash-2"><div class="hr-line l"></div><div class="hr-icon"><a href="https://www.cnblogs.com/xrst"><img src="/links/cnblogs.png" height="32px"></a></div><div class="hr-icon"><a href="http://jsrun.net/u/zjli"><img src="/links/jsrun.png" height="32px"></a></div><div class="hr-icon"><a href="https://github.com/ZhujinLi"><img src="/links/github.png" height="32px"></a></div><div class="hr-icon"><a href="https://www.shadertoy.com/user/zjli"><img src="/links/shadertoy.png" height="32px"></a></div><div class="hr-line r"></div></div></div><script src="/main.js" type="module"></script></body></html>